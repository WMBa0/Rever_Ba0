# 字符串混淆说明

存在init_array段，是孤挺花ollvm版本。so dump即可进行去混淆。
```
__int64 __fastcall dec(__int64 result, _BYTE *a2, unsigned int a3)
{
  int v3; // w10
  __int64 v4; // x13
  char v5; // w11
  __int64 v6; // x10
  signed int v7; // w8
  __int64 v8; // x11
  char v9; // w13

  if ( a3 >= 8 )
  {
    v3 = 7;
    do
    {
      *(_BYTE *)(result + v3 - 7) ^= *a2;
      *(_BYTE *)(result + v3 - 6) ^= a2[1];
      *(_BYTE *)(result + v3 - 5) ^= a2[2];
      *(_BYTE *)(result + v3 - 4) ^= a2[3];
      *(_BYTE *)(result + v3 - 3) ^= a2[4];
      *(_BYTE *)(result + v3 - 2) ^= a2[5];
      v4 = v3;
      *(_BYTE *)(result + v3 - 1) ^= a2[6];
      v5 = *(_BYTE *)(result + v3);
      v3 += 8;
      *(_BYTE *)(result + v4) = a2[7] ^ v5;
    }
    while ( (a3 & 7) - a3 + v3 != 7 );
  }
  if ( (a3 & 7) != 0 )
  {
    v6 = a3 & 7;
    v7 = a3 - 1;
    do
    {
      v8 = v7;
      v9 = *(_BYTE *)(result + v7--);
      *(_BYTE *)(result + v8) = a2[--v6] ^ v9;
    }
    while ( v6 );
  }
  return result;
}
```

形如这样

```
.text:00000000001FA894 FE 0F 1F F8                   STR             X30, [SP,#var_10]!
.text:00000000001FA898 A0 0B 00 90                   ADRP            X0, #unk_36EB27@PAGE
.text:00000000001FA89C C1 06 00 D0                   ADRP            X1, #unk_2D4B86@PAGE
.text:00000000001FA8A0 00 9C 2C 91                   ADD             X0, X0, #unk_36EB27@PAGEOFF
.text:00000000001FA8A4 21 18 2E 91                   ADD             X1, X1, #unk_2D4B86@PAGEOFF
.text:00000000001FA8A8 42 02 80 52                   MOV             W2, #0x12
.text:00000000001FA8AC 0E 00 00 94                   BL              dec1
.text:00000000001FA8AC
.text:00000000001FA8B0 A0 0B 00 90                   ADRP            X0, #unk_36EB39@PAGE
.text:00000000001FA8B4 C1 06 00 D0                   ADRP            X1, #unk_2D4B8E@PAGE
.text:00000000001FA8B8 00 E4 2C 91                   ADD             X0, X0, #unk_36EB39@PAGEOFF
.text:00000000001FA8BC 21 38 2E 91                   ADD             X1, X1, #unk_2D4B8E@PAGEOFF
.text:00000000001FA8C0 A2 01 80 52                   MOV             W2, #0xD
.text:00000000001FA8C4 08 00 00 94                   BL              dec1
.text:00000000001FA8C4
.text:00000000001FA8C8 A0 0B 00 90                   ADRP            X0, #unk_36EB46@PAGE
.text:00000000001FA8CC C1 06 00 D0                   ADRP            X1, #unk_2D4B96@PAGE
.text:00000000001FA8D0 00 18 2D 91                   ADD             X0, X0, #unk_36EB46@PAGEOFF
.text:00000000001FA8D4 21 58 2E 91                   ADD             X1, X1, #unk_2D4B96@PAGEOFF
.text:00000000001FA8D8 82 08 80 52                   MOV             W2, #0x44 ; 'D'
.text:00000000001FA8DC FE 07 41 F8                   LDR             X30, [SP+0x10+var_10],#0x10
.text:00000000001FA8E0 01 00 00 14                   B               dec1
```